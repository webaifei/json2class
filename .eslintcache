[{"/Users/oker/projects/tmp/json2class/src/reportWebVitals.js":"1","/Users/oker/projects/tmp/json2class/src/App.js":"2","/Users/oker/projects/tmp/json2class/src/utils.js":"3","/Users/oker/projects/tmp/json2class/src/index.js":"4"},{"size":362,"mtime":1608815948777,"results":"5","hashOfConfig":"6"},{"size":3935,"mtime":1608909663616,"results":"7","hashOfConfig":"6"},{"size":757,"mtime":1608863439830,"results":"8","hashOfConfig":"6"},{"size":500,"mtime":1608815948775,"results":"9","hashOfConfig":"6"},{"filePath":"10","messages":"11","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"eragaq",{"filePath":"12","messages":"13","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"14"},{"filePath":"15","messages":"16","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"17","messages":"18","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"19"},"/Users/oker/projects/tmp/json2class/src/reportWebVitals.js",[],"/Users/oker/projects/tmp/json2class/src/App.js",["20"],"\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport Handlebars from 'handlebars';\nimport AceEditor from \"react-ace\";\nimport './App.css';\nimport { is, TYPES, isTimestamp, capitalize } from './utils';\nimport \"ace-builds/src-noconflict/mode-json\";\nimport \"ace-builds/src-noconflict/mode-javascript\";\nimport \"ace-builds/src-noconflict/theme-solarized_dark\";\nimport \"ace-builds/src-noconflict/theme-solarized_light\";\n\nfunction App() {\n  const [code, setCode] = useState('');\n  const [jsonStr, setJsonStr] = useState('');\n  const [modelName, setModelName] = useState('');\n  const [error, setError] = useState('');\n  let needDateFormat = useRef(false);\n  const templateSource = `\n    import { makeAutoObservable, toJS } from 'mobx';\n    {{#if needDateFormat}}\n    import dayjs from 'dayjs';\n    import { dateFormat } from '@config/index';\n    {{/if}}\n\n    /**\n     * {{modelName}}\n     */\n    export default class {{modelName}} {\n      {{#each json}}\n      {{{@key}}} = {{{@this}}};\n      {{/each}}\n      // 你可以精细的控制赋值的过程\n      constructor(json) {\n        makeAutoObservable(this);\n        // const {id} = json;\n        // this.id = id;\n        Object.assign(this, json);\n      }\n\n      {{#each computed}}\n      {{{@key}}} = {{{@this}}};\n      {{/each}}\n      // 你可以精细的控制赋值的过程\n      updateFromJson(json) {\n        // const {id} = json;\n        // this.id = id;\n        // ...\n        Object.assign(this, json);\n      }\n      toJSON() {\n        return toJS(this);\n      }\n    }\n    `;\n  const template = Handlebars.compile(templateSource);\n  const formatJSONAndGetComputed  = useCallback(\n    (json) => {\n      console.log(json, 'origin--');\n      const computed = {};\n      for(let key in json) {\n        console.log(key, 'key')\n        needDateFormat.current = false;\n        const value = json[key];\n        if(isTimestamp(value)) {\n          json[key]=`'--'`;\n          computed[`get computed${capitalize(key)}`] = `() {\n          return dayjs(this.${key}).format(dateFormat)\n        };`;\n          needDateFormat.current = true;\n        } else if(is(value, TYPES.Array)) {\n          json[key]= `[]`;\n        } else if(is(value, TYPES.Null) || is(value, TYPES.Object)) {\n          json[key]= `{}`;\n        } else  {\n          json[key] = `'--'`;\n        }\n      }\n      return computed;\n    },\n    [],\n  )\n  useEffect(() => {\n    if(jsonStr) {\n      try {\n        let json = JSON.parse(jsonStr);\n        const computed = formatJSONAndGetComputed(json);\n        const newCode = template({json,computed, modelName, needDateFormat: needDateFormat.current});\n        console.log(newCode, json,'newCode');\n        setCode(newCode);\n      } catch(err) {\n        // setError(err);\n        console.log(err);\n      }\n\n    }\n    return () => {\n    }\n  }, [jsonStr, template, modelName, formatJSONAndGetComputed]);\n  return (\n    <div className=\"App\">\n      <p className=\"App-header\">\n      Generate Mobx Model class with JSON.\n      </p>\n      <p>{error.message}</p>\n      <input\n        className=\"form-control\" type=\"text\" value={modelName} placeholder=\"input your model name e.g TestModel\" onChange={(e)=> {\n            setModelName(e.target.value);\n      }}/>\n      <div className=\"content\">\n        <div className=\"left\">\n          <AceEditor\n            width=\"100%\"\n            mode=\"json\"\n            theme=\"solarized_dark\"\n            onChange={(newValue)=> {\n              setJsonStr(newValue);\n            }}\n            name=\"UNIQUE_ID_OF_DIV\"\n            editorProps={{ $blockScrolling: true }}\n          />\n        </div>\n        <div className=\"right\">\n          <AceEditor\n            width=\"100%\"\n            mode=\"javascript\"\n            value={code}\n            theme=\"solarized_light\"\n            name=\"UNIQUE_ID_OF_DIV_2\"\n            editorProps={{ $blockScrolling: true }}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","/Users/oker/projects/tmp/json2class/src/utils.js",[],"/Users/oker/projects/tmp/json2class/src/index.js",[],["21","22"],{"ruleId":"23","severity":1,"message":"24","line":16,"column":17,"nodeType":"25","messageId":"26","endLine":16,"endColumn":25},{"ruleId":"27","replacedBy":"28"},{"ruleId":"29","replacedBy":"30"},"no-unused-vars","'setError' is assigned a value but never used.","Identifier","unusedVar","no-native-reassign",["31"],"no-negated-in-lhs",["32"],"no-global-assign","no-unsafe-negation"]